<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Hi Albee – Reset Password</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 2rem auto;
      line-height: 1.6;
    }
    #container {
      padding: 1rem 0;
    }
    pre {
      background: #f5f5f5;
      padding: 1rem;
      border-radius: 6px;
      overflow-x: auto;
    }
    .error {
      color: #b00020;
      font-weight: bold;
    }
    .ok {
      color: #006400;
      font-weight: bold;
    }
  </style>
</head>

<body>
  <h1>Hi Albee – Reset Password</h1>

  <div id="container">
    <p>Inspecting reset link…</p>
  </div>

  <script>
    const container = document.getElementById("container");

    const rawHash = window.location.hash || "";
    const params = new URLSearchParams(rawHash.slice(1));

    const accessToken = params.get("access_token");
    const type = params.get("type");

    let html = "";

    html += "<h2>Reset Link Diagnostics</h2>";

    html += "<p><strong>Raw URL:</strong></p>";
    html += `<pre>${window.location.href}</pre>`;

    html += "<p><strong>window.location.hash:</strong></p>";
    html += `<pre>${rawHash || "(empty)"}</pre>`;

    if (!rawHash) {
      html += `<p class="error">No hash fragment found. This page was opened without a reset token.</p>`;
    } else {
      html += "<p><strong>Parsed values:</strong></p><ul>";

      html += `<li>access_token: ${
        accessToken ? "<span class='ok'>present</span>" : "<span class='error'>missing</span>"
      }</li>`;

      html += `<li>type: ${
        type ? `<span class="ok">${type}</span>` : "<span class='error'>missing</span>"
      }</li>`;

      html += "</ul>";

      if (type && type !== "recovery") {
        html += `<p class="error">Unexpected link type. Expected <code>recovery</code>.</p>`;
      }

      if (accessToken && type === "recovery") {
        html += `<p class="ok">
          Reset link looks structurally valid.
          <br />
          (No password reset has been attempted.)
        </p>`;
      }
    }

    html += `
      <p style="margin-top: 2rem; font-size: 0.9rem; color: #666;">
        This page is currently in <strong>diagnostic mode</strong>.
        <br />
        No authentication or password changes occur here.
      </p>
    `;

    container.innerHTML = html;
  </script>
</body>
</html>
